# Ansible Role: vector-role

Устанавливает и настраивает [Vector](https://vector.dev/) — агент для сбора, трансформации и доставки логов, метрик и трейсов.

Роль устанавливает Vector на хосты под управлением Ubuntu и настраивает базовую конфигурацию через шаблон.

## Требования

- Операционная система: Ubuntu 20.04, 22.04, 24.04
- Ansible 2.10 или новее
- Python 3 на целевых хостах

## Переменные

Роль поддерживает следующие переменные, которые можно переопределить в `vars` или `inventory`.

### Основные переменные

| Переменная | Описание | По умолчанию |
|-----------|---------|-------------|
| `vector_config_path` | Путь к конфигурационному файлу Vector | `/etc/vector/vector.yaml` |
| `vector_user` | Пользователь, от которого работает Vector | `vector` |
| `vector_group` | Группа, от которой работает Vector | `vector` |

### Дополнительные переменные (в `defaults/main.yml`)

Переменные по умолчанию можно переопределить:

```yaml
vector_config_path: /etc/vector/vector.yaml
vector_user: vector
vector_group: vector
```

### Зависимости 

Нет. Роль автономна. 

## Примеры использования 

### Простое применение 

```yaml
- hosts: vector
  roles:
    - vector-role
```

### Переопределение переменных

``` yaml
- hosts: vector
  roles:
    - role: vector-role
      vars:
        vector_config_path: /etc/vector/custom.yaml
```

### Внутренняя структура 
**tasks/main.yml** 

- Обновляет кэш пакетов
- Устанавливает Vector через **apt**
- Создаёт директорию для логов
- Копирует конфигурацию из шаблона
- Управляет службой Vector
     

**handlers/main.yml**

- **Restart Vector** — перезапускает службу после изменения конфигурации
     

**templates/vector.yaml.j2**

- Шаблон конфигурации Vector в формате YAML
- Поддерживает переменные и динамическую генерацию

## Совместимость
| Платформа | Поддердивается | 
|-----------|---------|
| Ubuntu 20.04 | ✅ |
| Ubuntu 22.04 | ✅ |
| Ubuntu 24.04 | ✅ |
| Debian | ❌ (не тестировалось) |
| RHEL/CentOS | ❌ (требует адаптации под yum) |

### Лицензия 

MIT      

## Автор 

**Барышков Михаил**

Роль создана в рамках домашнего задания по курсу "DevOps: с нуля до профи".

Можно использовать и модифицировать свободно. 